<!DOCTYPE html>
<html manifest="cache.manifest">
<head>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="target-densitydpi=device-dpi, width=device-width, user-scalable=no, maximum-scale=1, minimum-scale=1"/>
    <link rel="apple-touch-icon" href="touch-icon-iphone.png" />
    <link rel="apple-touch-icon" sizes="76x76" href="touch-icon-ipad.png" />
    <link rel="apple-touch-icon" sizes="120x120" href="touch-icon-iphone-retina.png" />
    <link rel="apple-touch-icon" sizes="152x152" href="touch-icon-ipad-retina.png"/>

    <title>Dumbest Offline GPS App Ever</title>
    <style type="text/css">
        #form input {
            display: block;
            clear: both;
            margin: 5px;
            padding: 5px;
        }
        #form button {
            margin: 5px;
            padding: 5px;
        }
    </style>
</head>
<body>
    <div id="form">
        <input type="text" id="title" placeholder="Title" />
        <input type="text" id="lat" placeholder="Latitude" />
        <input type="text" id="lon" placeholder="Longitude" />
        <button onclick=" markWithGps(); ">Mark</button>
        <button onclick=" addItem(); ">Add</button>

        <ul id="list"></ul>
    </div>
    <script type="text/javascript">
        var items = [];

        function markWithGps() {
            navigator.geolocation.getCurrentPosition(onMarkPosition);
        }

        function onMarkPosition(pos) {
            document.getElementById('lat').value = pos.coords.latitude;
            document.getElementById('lon').value = pos.coords.longitude;
        }

        function addItemToList(item) {
            var list = document.getElementById('list');
            var newListItem = document.createElement('li');
            newListItem.innerText = item.title + " " + item.lat + " " + item.lon;
            list.appendChild(newListItem);
        }

        function addItem() {

            var newItem = {
                title: document.getElementById('title').value,
                lat: document.getElementById('lat').value,
                lon: document.getElementById('lon').value
            }

            addItemToList(newItem);

            window.items.push(newItem);
            window.localStorage.setItem('dumbest.items', JSON.stringify(window.items));

            document.getElementById('title').value = "";
            document.getElementById('lat').value = "";
            document.getElementById('lon').value = "";
        }

        function init() {
            var json = window.localStorage.getItem('dumbest.items') || '[]';
            window.items = JSON.parse(json);
            for (var i = 0; i < window.items.length; i++) {
                var item = window.items[i];
                addItemToList(item);
            }
        }

        init();
    </script>
</body>
</html>
